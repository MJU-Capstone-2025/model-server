# 모델 서버 설계 문서

## 1. 시스템 구조

### 1.1 서버 구성

-   FastAPI 기반 비동기 API 서버
-   데이터 수집, 전처리, 학습, 예측 모듈
-   파일 기반(`.csv`) 데이터 저장소

## 2. 서버 flow chart

![flow-chart](https://raw.githubusercontent.com/MJU-Capstone-2025/model-server/8a075fecf3efeb94c0aef9547c8ee61c9852fa7b/docs/server-flowchart.drawio.svg)

### 2.1 메인 서버 흐름

1. `main.py` 실행 시 병렬 처리:

    - 데이터 수집 및 모델 학습 프로세스
    - API 엔드포인트 (/prediction)

2. 예측 결과 요청 처리:
    - 예측 결과 존재 시 → 즉시 반환
    - 결과 미존재 시 → 모델 학습 진행

### 2.2 데이터 수집 프로세스

1. 뉴스 데이터:

    - 최신 데이터 존재 여부 확인
    - 미존재 시 자동 수집
    - 수집 데이터 전처리 및 저장

2. 기후/거시경제 데이터:
    - 최신 데이터 존재 여부 확인
    - 미존재 시 자동 수집
    - 수집 데이터 전처리 및 저장

### 2.3 모델 학습 흐름

1. 뉴스 데이터 처리:

    - 핵심 기사 필터링
    - 모델 학습 및 결과 저장

2. 기후/경제 데이터 처리:

    - 모델 학습 및 결과 저장

3. 모델 통합 및 반환:
    - 두 모델의 결과 통합
    - 최종 예측 결과 저장
    - 두 가지 응답 방식:
        - 예측 결과가 있는 경우: 즉시 데이터 반환
        - 예측 결과가 없는 경우: 전날 예측 결과 반환하며 새로운 예측 진행

### 2.4 주요 특징

-   데이터 자동 수집 구현
-   일일 단위 모델 예측 갱신
-   실시간 API 응답
-   모듈식 데이터 처리 구조
